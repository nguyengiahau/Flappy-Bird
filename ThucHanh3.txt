Cau 1: ALTER TABLE KHACHHANG ADD PRIMARY KEY(MAKH);

1.5.3 Ngôn ngữ truy vấn dữ liệu
Cau 1: 
SELECT MASP, TENSP FROM SANPHAM WHERE NUOCSX="Trung Quoc";
Cau 2: 
SELECT MASP, TENSP FROM SANPHAM WHERE DVT="cay" OR DVT="quyen";
Cau 3: 
SELECT MASP, TENSP FROM SANPHAM WHERE MASP LIKE "B%01";
Cau 4: 
SELECT MASP, TENSP FROM SANPHAM WHERE NUOCSX="Trung Quoc" AND (GIA BETWEEN 30000 AND 40000);
Cau 5: 
SELECT MASP, TENSP FROM SANPHAM WHERE (NUOCSX="Trung Quoc" OR NUOCSX="Thai Lan") AND (GIA BETWEEN 30000 AND 40000);
Cau 6: 
SELECT *FROM HOADON WHERE NGHD = '2011-1-1' OR NGHD ='2011-1-2';
Cau 7: 
SELECT SOHD, TRIGIA FROM HOADON WHERE NGHD>='2011-01-01' AND NGHD<'2011-02-01' ORDER BY NGHD ASC, TRIGIA DESC;
CAU 8: 
SELECT KH.MAKH, KH.HOTEN FROM KHACHHANG KH JOIN HOADON HD ON KH.MAKH =HD.MAKH WHERE HD.NGHD='2011-01-01';
Cau 9: 
SELECT HD.SOHD, HD.TRIGIA FROM HOADON HD JOIN NHANVIEN NV ON HD.MANV = NV.MANV WHERE NV.HOTEN = "Nguyen Van B" AND HD.NGHD >= '2010-10-1' AND HD.NGHD < '2010-11-1';
Cau 10: 
SELECT SP.MASP, SP.TENSP FROM SANPHAM SP JOIN CTHD CT ON SP.MASP = CT.MASP JOIN HOADON HD ON HD.SOHD = CT.SOHD JOIN KHACHHANG KH ON KH.MAKH = HD.MAKH WHERE KH.HOTEN = 'Nguyen Van A' AND HD.NGHD >= '2010-10-01' AND HD.NGHD < '2010-11-01';
Cau 11:
SELECT SOHD FROM CTHD WHERE MASP = "BB01" OR MASP = "BB02";
Cau 12:
SELECT SOHD FROM CTHD WHERE (MASP = "BB01" OR MASP = "BB02") AND SL BETWEEN 10 AND 20;
Cau 13:
SELECT SOHD FROM CTHD WHERE ( MASP ="BB01" OR MASP ="BB02") AND SL BETWEEN 10 AND 20 GROUP BY SOHD HAVING
COUNT(MASP) = 2;
Cau 14: 
SELECT DISTINCT  SP.MASP, SP.TENSP FROM SANPHAM SP JOIN CTHD CT ON SP.MASP = CT.MASP JOIN HOADON HD ON HD.SOHD = CT.SOHD WHERE SP.NUOCSX="Trung Quoc" OR HD.SOHD ='2011-01-01';
Cau 15: 
SELECT MASP, TENSP FROM SANPHAM WHERE MASP NOT IN (SELECT MASP FROM CTHD);
Cau 16: 
SELECT MASP, TENSP FROM SANPHAM WHERE MASP NOT IN (SELECT MASP FROM HOADON HD JOIN CTHD CT ON CT.SOHD = HD.SOHD WHERE YEAR(HD.NGHD)='2010');
Cau 17: 
SELECT MASP, TENSP FROM SANPHAM WHERE MASP NOT IN (SELECT MASP FROM HOADON HD JOIN CTHD CT ON CT.SOHD = HD.SOHD WHERE YEAR(HD.NGHD)='2010') AND NUOCSX = "Trung Quoc";
Cau 18: 
SELECT COUNT(*) FROM HOADON WHERE MAKH IS NULL;
Cau 19:
SELECT COUNT(DISTINCT MASP) FROM CTHD WHERE MASP IN (SELECT DISTINCT CT.MASP FROM HOADON HD JOIN CTHD CT ON HD.SOHD = CT.SOHD WHERE YEAR(HD.NGHD)=2010);
Cau 20: 
SELECT MAX(TRIGIA) AS HDMAX, MIN(TRIGIA) AS HDMIN FROM HOADON;
Cau 21:
SELECT AVG(TRIGIA) FROM HOADON WHERE YEAR(NGHD) =2010;
Cau 22:
SELECT SUM(TRIGIA) FROM HOADON WHERE YEAR(NGHD) =2010;
Cau 23:
SELECT MAX(TRIGIA) FROM HOADON WHERE YEAR(NGHD) =2010;
Cau 24: 
SELECT KH.HOTEN FROM KHACHHANG KH JOIN HOADON HD ON KH.MAKH = HD.MAKH ORDER BY TRIGIA DESC LIMIT 1;
Cau 25:
SELECT MAKH, HOTEN FROM KHACHHANG ORDER BY DOANHSO DESC LIMIT 3;
Cau 26:
SELECT MASP, TENSP FROM SANPHAM ORDER BY GIA DESC LIMIT 3;
Cau 27:
SELECT SP.MASP, SP.TENSP, SP.GIA, T.GIA FROM SANPHAM SP JOIN (SELECT GIA FROM SANPHAM ORDER BY GIA DESC LIMIT 3) AS T ON T.GIA = SP.GIA WHERE SP.NUOCSX = 'Thai Lan';
Cau 28:
SELECT SP.MASP, SP.TENSP, SP.GIA, T.GIA FROM SANPHAM SP JOIN (SELECT GIA FROM SANPHAM WHERE NUOCSX='Trung Quoc' ORDER BY GIA DESC LIMIT 3) AS T ON T.GIA = SP.GIA WHERE SP.NUOCSX = 'Trung Quoc';
Cau 29:
SELECT HOTEN, DOANHSO FROM KHACHHANG ORDER BY DOANHSO DESC LIMIT 3;
Cau 30:
SELECT COUNT(NUOCSX) FROM SANPHAM WHERE NUOCSX='Trung Quoc';
Cau 31: 
SELECT NUOCSX, COUNT(NUOCSX) AS SOLUONG FROM SANPHAM GROUP BY NUOCSX;
Cau 32: 
SELECT NUOCSX, MAX(GIA) AS GIACAONHAT, MIN(GIA) AS GIATHAPNHAT, AVG(GIA) AS GIATRUNGBINH FROM SANPHAM GROUP BY NUOCSX;
Cau 33: 
SELECT NGHD, SUM(TRIGIA) FROM HOADON GROUP BY NGHD ORDER BY NGHD;
Cau 34:
SELECT CT.MASP, SP.TENSP, SUM(CT.SL) AS TONGSOLUONG FROM CTHD CT JOIN HOADON HD ON
CT.SOHD = HD.SOHD JOIN SANPHAM SP ON CT.MASP = SP.MASP WHERE YEAR(HD.NGHD) = 2010 AND MONTH(HD.NGHD) = 10 GROUP BY CT.MASP, SP.TENSP;
Cau 35:
SELECT MONTH(NGHD), SUM(TRIGIA) AS DOANHTHU FROM HOADON WHERE YEAR(NGHD) = 2010 GRO
UP BY MONTH(NGHD);
Cau 36:
SELECT SOHD, COUNT(DISTINCT MASP) FROM CTHD GROUP BY SOHD HAVING COUNT(DISTINCT MASP)>=4;
Cau 37:
SELECT CT.SOHD, COUNT(DISTINCT CT.MASP) FROM CTHD CT JOIN SANPHAM SP ON SP.MASP = CT.MASP WHERE SP.NUOCSX="Viet Nam" GROUP BY SOHD HAVING COUNT(DISTINCT CT.MASP)>=3;
Cau 38:
SELECT HOTEN FROM KHACHHANG KH JOIN (SELECT MAKH, COUNT(MAKH) FROM HOADON GROUP BY MAKH LIMIT 1) AS T ON KH.MAKH = T.MAKH;
Cau 39:
SELECT MONTH(NGHD), SUM(TRIGIA) FROM HOADON WHERE YEAR(NGHD) = 2010 GROUP BY MONTH(NGHD) ORDER BY SUM(TRIGIA) DESC LIMIT 1;
Cau 40:
SELECT SP.MASP, SP.TENSP FROM SANPHAM SP JOIN  (SELECT MASP, SUM(SL) FROM CTHD GROUP BY MASP ORDER BY SUM(SL) LIMIT 1) AS T ON SP.MASP = T.MASP;








